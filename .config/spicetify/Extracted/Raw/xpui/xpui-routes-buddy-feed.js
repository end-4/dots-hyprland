"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[7564],{66099:(e,s,i)=>{i.r(s),i.d(s,{default:()=>ve});var a=i(30758),r=i(43752),t=i(93492),n=i(60749),l=i(13505),c=i(555),d=i(97500),u=i.n(d),o=i(45959);const m="jGcEaPyhr1c_janM2uRF",x="OemaZktMXaRcYQ5bcfLZ",h="o5IJsOJEWBEyxtPVVVqQ",j="toPt7VOT_PiDx5Gj3SM2",g="xU4sacBisQneHoQeHMP5",f="srjSlmxMGzXnJBc32BJa",p="lju7xv10a5Y5Z8h8CcKJ",N="jr794VV4i2iUBRhfvS5i",b="KE3gK5ccLz2gL3dhJ4BW",y="pO2rsGFqUdaNhpLrif21",v="Ydxgl4Y23orfVVVI9O2k",S="VhqWrkzIrJrvdyj7ZXMd",I="T3liC_3fbMOTilR4HHKD",P="W_tr6AMQB9Chbc9bCS9w",w="yDdNxgieZmqjgHQCW3UE",L="aikUDGtqRnCX0ZwYHDUW",R="T_HXMW6n5qsbLbPTr1GS",k="tYswKV9PmtTCv62LOPIV",B="GlDNRQ2w0t4h9WBI4GgN",_="BQGSV5BvuAaJ5rmFAXLp",Q="ZLbFjRdp1AMXebZH6UWM",T="jhtyHt6d9vbxK6VtCI7a",C="oCaGCB13zdReRutfBS8_",G="MR1n58Qu0kPorQtveOCQ",U="y10vXronmQ6eYMlJrIp3";var D=i(86070);const E=({showOnlineIndicator:e})=>(0,D.jsxs)("div",{className:k,children:[(0,D.jsxs)("div",{className:B,children:[(0,D.jsx)(o.v,{size:"medium"}),e?(0,D.jsx)("div",{className:_}):null]}),(0,D.jsxs)("div",{className:Q,children:[(0,D.jsx)("div",{className:u()(T,C)}),(0,D.jsx)("div",{className:T}),(0,D.jsx)("div",{className:T})]})]}),A=()=>(0,D.jsxs)("div",{"data-testid":"buddy-feed-empty-state",className:L,children:[(0,D.jsx)(l.E,{as:"p",className:R,children:t.Ru.get("buddy-feed.let-followers-see-your-listening")}),(0,D.jsx)(E,{showOnlineIndicator:!0}),(0,D.jsx)(E,{showOnlineIndicator:!0}),(0,D.jsx)(E,{}),(0,D.jsx)(l.E,{as:"p",className:R,children:t.Ru.get("buddy-feed.enable-share-listening-activity")}),(0,D.jsx)(n.N_,{to:"/preferences",className:G,children:(0,D.jsx)(c.$,{colorSet:"invertedLight",className:U,children:t.Ru.get("desktop.settings.settings")})})]});var M=i(68832),O=i(72574),V=i(19837),Z=i(12367),H=i(56463),F=i(96691),W=i(26630),Y=i(39550),J=i(71070),z=i(34855),K=i(5119),X=i(78245),q=i(74584),$=i(92197),ee=i(29888);const se=e=>{const{timestamp:s,isNowPlaying:i}=e;return i?(0,D.jsx)($.Zp,{label:t.Ru.get("time.now"),children:(0,D.jsx)(q.A,{"aria-label":t.Ru.get("time.now"),size:"small"})}):(0,D.jsx)("span",{children:(0,ee.Z)(s)})};var ie=i(64212),ae=i(58487),re=i(24395),te=i(46307),ne=i(99802),le=i(78172);const ce=e=>Date.now()-e<9e5,de=(e,s)=>{const i=(0,O.o_h)(e)?.type;switch(i){case O.NQG.PLAYLIST:case O.NQG.PLAYLIST_V2:return(0,D.jsx)(W.W,{uri:e});case O.NQG.EPISODE:case O.NQG.SHOW:return(0,D.jsx)(Y.H,{uri:e});case O.NQG.ALBUM:return(0,D.jsx)(H.h,{uri:e,artistUri:s});case O.NQG.ARTIST:return(0,D.jsx)(F.t,{uri:e});default:return null}},ue=e=>{switch(e){case O.NQG.ALBUM:return le.c.ALBUM;case O.NQG.ARTIST:return le.c.ARTIST;case O.NQG.SHOW:return le.c.SHOW;case O.NQG.EPISODE:return le.c.EPISODE;case O.NQG.PLAYLIST:case O.NQG.PLAYLIST_V2:return le.c.PLAYLIST;default:return}},oe=e=>{const{show:s=!0,spec:i,friend:r}=e,n=(0,a.useMemo)((()=>r.user.imageUrl?[{url:r.user.imageUrl,width:0,height:0}]:[]),[r.user.imageUrl]),c=(0,ne.s)(),d=r.track,o=d.uri,{togglePlay:x,isPlaying:h,isActive:j}=(0,te.P)({uri:o},{featureIdentifier:"buddy_feed",referrerIdentifier:"buddy_feed"}),L=(0,O.o_h)(d.context.uri),R=L?.type,k=(0,a.useCallback)((()=>{x();const e=i.friendRowFactory().playButtonFactory();j?h?c.logInteraction(e.hitPause({itemToBePaused:o})):c.logInteraction(e.hitResume({itemToBeResumed:o})):c.logInteraction(e.hitPlay({itemToBePlayed:o}))}),[h,o,i,j,x,c]),B=(0,a.useCallback)(((e,s)=>{c.logInteraction(i.friendRowFactory().friendRowLinkFactory({identifier:e}).hitUiNavigate({destination:s}))}),[c,i]),{draggable:_,onDragStart:Q}=(0,ie.P)({itemUris:[o],dragLabelText:d.name}),{draggable:T,onDragStart:C}=(0,ie.P)({itemUris:[d.artist.uri],dragLabelText:d.artist.name}),{draggable:G,onDragStart:U}=(0,ie.P)({itemUris:[d.context.uri],dragLabelText:d.context.name});return s?(0,D.jsxs)("div",{className:u()(m),children:[(0,D.jsx)(Z.h,{menu:de(d.context.uri,d.artist.uri),children:(0,D.jsxs)("div",{className:g,children:[(0,D.jsx)(V.e,{label:r.user.name,width:40,userIconSize:"small",images:n,withBadge:ce(r.timestamp)}),(0,D.jsx)(X.x,{className:f,iconClassName:p,isPlaying:h,isLocked:!1,onClick:k,playAriaLabel:h?t.Ru.get("pause"):`${t.Ru.get("play")} ${d.artist.name} ${d.name}`})]})}),(0,D.jsxs)("div",{className:u()(N),children:[(0,D.jsxs)("div",{className:b,children:[(0,D.jsx)(l.E,{as:"p",variant:"bodySmallBold",className:u()(y,"ellipsis-one-line"),children:(0,D.jsx)(re.pZ,{value:"/buddyfeed_user_profile",children:(0,D.jsx)(Z.h,{menu:(0,D.jsx)(z.B,{uri:r.user.uri}),children:(0,D.jsx)(K.N,{title:r.user.name,to:r.user.uri,dir:"auto",onClick:()=>B("profile_link",r.user.uri),children:r.user.name})})})}),(0,D.jsx)(l.E,{as:"p",variant:"marginal",className:u()(v),children:(0,D.jsx)(se,{timestamp:r.timestamp,isNowPlaying:ce(r.timestamp)})})]}),(0,D.jsxs)(l.E,{as:"p",variant:"marginal",className:S,children:[(0,D.jsx)(re.pZ,{value:"/buddyfeed_track",children:(0,D.jsx)(Z.h,{menu:(0,D.jsx)(J.P,{uri:d.uri,contextUri:d.context.uri,albumUri:d.album.uri,artists:[d.artist]}),children:(0,D.jsx)(K.N,{title:d.name,to:o,className:"ellipsis-one-line",dir:"auto",draggable:_,onDragStart:Q,onClick:()=>B("track_link",o),children:d.name})})}),(0,D.jsx)("span",{"aria-hidden":!0,children:" • "}),(0,D.jsx)(re.pZ,{value:"/buddyfeed_artist",children:(0,D.jsx)(Z.h,{menu:d.artist?(0,D.jsx)(F.t,{uri:d.artist.uri}):null,children:(0,D.jsx)(K.N,{title:d.artist.name,to:d.artist.uri,className:"ellipsis-one-line",dir:"auto",draggable:T,onDragStart:C,onClick:()=>B("artist_link",d.artist.uri),children:d.artist.name})})})]}),(0,D.jsx)(l.E,{as:"p",variant:"marginal",className:u()("ellipsis-one-line",P),children:(0,D.jsx)(re.pZ,{value:"/buddyfeed_context",children:(0,D.jsx)(Z.h,{menu:de(d.context.uri,d.artist.uri),children:(0,D.jsxs)(K.N,{title:d.context.name,to:d.context.uri,className:w,draggable:G,onDragStart:U,onClick:()=>B("context_link",d.context.uri),children:[(0,D.jsx)(ae.s,{type:ue(R),iconSize:16,className:I}),(0,D.jsx)("span",{dir:"auto",className:"ellipsis-one-line",children:d.context.name})]})})})})]})]},r.user.uri):null};var me=i(56105),xe=i(27276),he=i(94822);function je({friends:e,spec:s}){const{currentSession:i}=(0,he.D)(),r=(0,xe.y)(),[t,n]=(0,a.useState)(!0),l=!i?.active&&r&&t&&(0,D.jsx)("li",{className:h,children:(0,D.jsx)(me.p,{localStorageKey:"dismissStartJamButtonFromFriendFeed",onDismiss:()=>n(!1)})},"start-jam-button");return(0,D.jsx)(M.ZI,{flipKey:e.map((e=>e.user.uri)).join(""),children:(0,D.jsxs)("ul",{className:x,children:[l,e.map(((e,i)=>(0,D.jsx)(M.lf,{flipId:e.user.uri,children:(0,D.jsx)("li",{children:(0,D.jsx)(oe,{friend:e,show:i<100,spec:s},e.user.uri)})},e.user.uri)))]})})}var ge=i(5658),fe=i(58540),pe=i(31845),Ne=i(75097),be=i(42372),ye=i(82362);const ve=({friends:e})=>{const s=(0,ne.s)(),{spec:i}=(0,ye.r)(r.W,{}),n=(0,a.useRef)(null);(0,a.useEffect)((()=>{s.logImpression(i.impression())}),[s,i]);const l=0===e.length,c=(0,a.useCallback)((()=>{s.logInteraction(i.closeButtonFactory().hitUiHide())}),[s,i]);return(0,D.jsx)(be.ql.Provider,{value:"buddy_feed",children:(0,D.jsx)(ge._,{label:t.Ru.get("buddy-feed.friend-activity"),focusTransferId:"BUDDY-FEED",children:(0,D.jsx)("div",{className:j,ref:n,children:(0,D.jsx)(fe.w,{fixedHeader:(0,D.jsx)(pe.a,{title:t.Ru.get("buddy-feed.friend-activity"),panel:Ne.Z.BuddyFeed,onClose:c}),children:l?(0,D.jsx)(A,{}):(0,D.jsx)(je,{friends:e,spec:i})})})})})}}}]);
//# sourceMappingURL=xpui-routes-buddy-feed.js.map